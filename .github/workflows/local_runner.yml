# name: My First Workflow

# on:
#   push:
#     branches: [ "main" ]
#   pull_request:
#     branches: [ "main" ]
#   workflow_dispatch:

# jobs:
#   build:
#     runs-on: self-hosted

#     steps:
#       # Checkout repository
#       - uses: actions/checkout@v4

#       # Build the Docker image
#       - name: Build Docker image
#         shell: powershell
#         run: |
#           $IMAGE_NAME = "hello-world-nginx"
#           $BRANCH_TAG = $env:GITHUB_REF_NAME
#           $SHA_TAG = $env:GITHUB_SHA

#           Write-Host "Building Docker image..."
#           docker build -t "${IMAGE_NAME}:latest" -t "${IMAGE_NAME}:${BRANCH_TAG}" -t "${IMAGE_NAME}:${SHA_TAG}" .

#       # Stop and remove old container if exists, then run new container
#       - name: Run Docker container
#         shell: powershell
#         run: |
#           if (docker ps -a --filter "name=hello-container" -q) {
#               Write-Host "Stopping and removing existing container..."
#               docker stop hello-container
#               docker rm hello-container
#           }
#           Write-Host "Starting new container..."
#           docker run -d -p 8080:80 --name hello-container hello-world-nginx:latest

#       # Show running containers
#       - name: List running containers
#         shell: powershell
#         run: docker ps

#       # Optional: Test that Nginx is responding
#       - name: Test Nginx container
#         shell: powershell
#         run: Invoke-WebRequest -Uri "http://localhost:8080" -UseBasicParsing
